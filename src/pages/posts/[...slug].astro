---
import "@splidejs/splide/css"
import { Splide, SplideSlide } from 'astro-splide'

import { getCollection, render } from 'astro:content'

import { Picture } from 'astro:assets'

import BaseLayout from '../../layouts/BaseLayout.astro'

export async function getStaticPaths() {
  const posts = await getCollection('posts')
  return posts.map(post => ({
    params: { slug: post.id }, props: { post },
  }))
}

const { post } = Astro.props
const { Content } = await render(post)

console.log(post.data.photos.length)

---

<BaseLayout>
  <div>
      <Splide
        class='not-content'
        options={ { 
          type: 'loop', 
          autoplay: false,
          arrows: post.data.photos.length > 1
        } }
      >

    {post.data.photos.map(photo => 
      <SplideSlide>
        <figure>
          <div class="image">
            <Picture src={photo.photourl} alt={photo.photocaption} width="1200" />
          </div>
          <figcaption class="has-text-centered">
            {photo.photocaption}
            <br><br>
          </figcaption>
        </figure>
      </SplideSlide>
    )}
  </div>
  <Content />
</BaseLayout>

